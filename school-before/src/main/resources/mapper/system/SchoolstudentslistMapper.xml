<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.project.system.schoolstudentslist.mapper.SchoolstudentslistMapper">
    
    <resultMap type="Schoolstudentslist" id="SchoolstudentslistResult">
        <result property="id"    column="id"    />
        <result property="studentsId"    column="students_id"    />
        <result property="studentsName"    column="students_name"    />
        <result property="gender"    column="gender"    />
        <result property="nianji"    column="nianji"    />
        <result property="birth"    column="birth"    />
        <result property="nation"    column="nation"    />
        <result property="idnum"    column="idnum"    />
        <result property="isrefuse"    column="isrefuse"    />
        <result property="approvalstate"    column="approvalstate"    />
        <result property="approvalstate"    column="approvalstate"    />
        <result property="academicLevel"    column="academic_level"    />
        <result property="fatherName"    column="father_name"    />
        <result property="fatherPhone"    column="father_phone"    />
        <result property="motherName"    column="mother_name"    />
        <result property="motherPhone"    column="mother_phone"    />
        <result property="homeAddress"    column="home_address"    />
        <result property="Remarks"    column="_remarks"    />
        <result property="ages"    column="ages"    />
        <result property="admissionTime"    column="admission_time"    />
        <result property="State"    column="_state"    />
        <result property="remark"    column="remark"    />
        <result property="remark1"    column="remark1"    />
        <result property="remark2"    column="remark2"    />
        <result property="remark3"    column="remark3"    />
        <result property="remark4"    column="remark4"    />
        <result property="remark5"    column="remark5"    />
        <result property="remark6"    column="remark6"    />
        <result property="remark7"    column="remark7"    />
        <result property="remark8"    column="remark8"    />
        <result property="remark9"    column="remark9"    />
        <result property="remark10"    column="remark10"    />
        <result property="remark11"    column="remark11"    />
        <result property="remark12"    column="remark12"    />
        <result property="remark13"    column="remark13"    />
        <result property="remark14"    column="remark14"    />
        <result property="remark15"    column="remark15"    />
        <result property="remark16"    column="remark16"    />
        <result property="remark17"    column="remark17"    />
        <result property="remark18"    column="remark18"    />
        <result property="remark19"    column="remark19"    />
        <result property="remark20"    column="remark20"    />
        <result property="lixian1"    column="lixian1"    />
        <result property="lixian2"    column="lixian2"    />
        <result property="lixian3"    column="lixian3"    />
        <result property="lixian4"    column="lixian4"    />
        <result property="lixian5"    column="lixian5"    />
        <result property="lixian6"    column="lixian6"    />
        <result property="lixian7"    column="lixian7"    />
        <result property="reportstate"    column="reportstate"    />
        <result property="notreportresult"    column="notreportresult"    />
        <result property="paystate"    column="paystate"    />
        <result property="isregister"    column="isregister"    />
        <result property="isreceivekey"    column="isreceivekey"    />
        <result property="isreceivejunxun"    column="isreceivejunxun"    />
        <result property="company"    column="company"    />
        <result property="comapproval"    column="comapproval"    />
        <result property="situation"    column="situation"    />
        <result property="post"    column="post"    />
        <result property="delFlag"    column="del_flag"    />
        <result property="deptalias"    column="deptAlias"    />
        <result property="useralias"    column="userAlias"    />
        <result property="gradeId"    column="grade_id"    />
        <result property="classId"    column="class_id"    />
        <result property="leavetime"    column="leavetime"    />
        <result property="userId"    column="user_id"    />
        <result property="sbid"    column="sbid"    />
        <result property="ssid"    column="ssid"    />
        <result property="sbid_"    column="sbid_"    />
        <result property="ssid_"    column="ssid_"    />
        <result property="ydtime"    column="ydtime"    />
        <result property="ydreason"    column="ydreason"    />
        <result property="cardnum"    column="cardnum"    />
    </resultMap>

    <sql id="selectSchoolstudentslistVo">
        select cardnum,sbid,YEAR(NOW())-YEAR(admission_time) as 'nianji',(select school_name from school_belong where id=sbid) as 'sbid_',(select name from school_specialty where id=ssid) as 'ssid_', ssid,ydreason,ydtime,user_id,id, students_id, students_name,gender,birth,nation,idnum,isrefuse,approvalstate, academic_level, father_name, father_phone, mother_name, mother_phone, home_address, _remarks, ages, admission_time, _state, remark, remark1, remark2, remark3, remark4, remark5, remark6, remark7, remark8, remark9, remark10, remark11, remark12, remark13, remark14, remark15, remark16, remark17,remark18,remark19,remark20,lixian7,lixian6,lixian5,lixian4,lixian3,lixian2,lixian1,reportstate,notreportresult,paystate,isregister,isreceivekey,isreceivejunxun,company,comapproval,post,situation, del_flag, deptAlias, userAlias, grade_id, class_id, (select sum(leavetime) from schoolstudentsleavelist l where l.del_flag='0' and l.studentid=s.id) as 'leavetime' from schoolstudentslist s
    </sql>
    
    <select id="selectStudengByIdnum" parameterType="Schoolstudentslist" resultMap="SchoolstudentslistResult">
    	select * from schoolstudentslist where idnum = #{idnum}
    </select>
    
    <select id="selectSchoolstudentslistList" parameterType="Schoolstudentslist" resultMap="SchoolstudentslistResult">
        <include refid="selectSchoolstudentslistVo"/>
        <where>  
            <if test="gender != null  and gender != ''"> and gender = #{gender}</if>
            <if test="birth != null  and studentsId != ''"> and birth = #{birth}</if>
            <if test="nation != null  and nation != ''"> and nation = #{nation}</if>
            <if test="idnum != null  and idnum != ''"> and idnum = #{idnum}</if>
            <if test="isrefuse != null  and isrefuse != ''"> and isrefuse = #{isrefuse}</if>
            <if test="approvalstate != null  and approvalstate != ''"> and approvalstate = #{approvalstate}</if>
            <if test="studentsId != null  and studentsId != ''"> and students_id = #{studentsId}</if>
            <if test="studentsName != null  and studentsName != ''"> and students_name like concat('%', #{studentsName}, '%')</if>
            <if test="academicLevel != null  and academicLevel != ''"> and academic_level = #{academicLevel}</if>
            <if test="fatherName != null  and fatherName != ''"> and father_name like concat('%', #{fatherName}, '%')</if>
            <if test="fatherPhone != null  and fatherPhone != ''"> and father_phone = #{fatherPhone}</if>
            <if test="motherName != null  and motherName != ''"> and mother_name like concat('%', #{motherName}, '%')</if>
            <if test="motherPhone != null  and motherPhone != ''"> and mother_phone = #{motherPhone}</if>
            <if test="homeAddress != null  and homeAddress != ''"> and home_address = #{homeAddress}</if>
            <if test="Remarks != null  and Remarks != ''"> and _remarks = #{Remarks}</if>
            <if test="ages != null  and ages != ''"> and ages = #{ages}</if>
            <if test="admissionTime != null "> and admission_time like concat('%', #{admissionTime}, '%')</if>
            <if test="State != null  and State != ''"> and _state = #{State}</if>
            <if test="remark1 != null  and remark1 != ''"> and remark1 = #{remark1}</if>
            <if test="remark2 != null  and remark2 != ''"> and remark2 = #{remark2}</if>
            <if test="remark3 != null  and remark3 != ''"> and remark3 = #{remark3}</if>
            <if test="remark4 != null  and remark4 != ''"> and remark4 = #{remark4}</if>
            <if test="remark5 != null  and remark5 != ''"> and remark5 = #{remark5}</if>
            <if test="remark6 != null  and remark6 != ''"> and remark6 = #{remark6}</if>
            <if test="remark7 != null  and remark7 != ''"> and remark7 = #{remark7}</if>
            <if test="remark8 != null  and remark8 != ''"> and remark8 = #{remark8}</if>
            <if test="remark9 != null  and remark9 != ''"> and remark9 = #{remark9}</if>
            <if test="remark10 != null  and remark10 != ''"> and remark10 = #{remark10}</if>
            <if test="remark11 != null  and remark11 != ''"> and remark11 = #{remark11}</if>
            <if test="remark12 != null  and remark12 != ''"> and remark12 = #{remark12}</if>
            <if test="remark13 != null  and remark13 != ''"> and remark13 = #{remark13}</if>
            <if test="remark14 != null  and remark14 != ''"> and remark14 = #{remark14}</if>
            <if test="remark15 != null  and remark15 != ''"> and remark15 = #{remark15}</if>
            <if test="remark16 != null  and remark16 != ''"> and remark16 = #{remark16}</if>
            <if test="remark17 != null  and remark17 != ''"> and remark17 = #{remark17}</if>
            <if test="remark18 != null  and remark18 != ''"> and remark18 = #{remark18}</if>
            <if test="remark19 != null  and remark19 != ''"> and remark19 = #{remark19}</if>
            <if test="remark20 != null  and remark20 != ''"> and remark20 = #{remark20}</if>
            <if test="lixian7 != null  and lixian7 != ''"> and lixian7 = #{lixian7}</if>
            <if test="lixian6 != null  and lixian6 != ''"> and lixian6 = #{lixian6}</if>
            <if test="lixian5 != null  and lixian5 != ''"> and lixian5 = #{lixian5}</if>
            <if test="lixian4 != null  and lixian4 != ''"> and lixian4 = #{lixian4}</if>
            <if test="lixian3 != null  and lixian3 != ''"> and lixian3 = #{lixian3}</if>
            <if test="lixian2 != null  and lixian2 != ''"> and lixian2 = #{lixian2}</if>
            <if test="lixian1 != null  and lixian1 != ''"> and lixian1 = #{lixian1}</if>
            <if test="reportstate != null  and reportstate != ''"> and reportstate = #{reportstate}</if>
            <if test="notreportresult != null  and notreportresult != ''"> and notreportresult = #{notreportresult}</if>
            <if test="paystate != null  and paystate != ''"> and paystate = #{paystate}</if>
            <if test="isregister != null  and isregister != ''"> and isregister = #{isregister}</if>
            <if test="isreceivekey != null  and isreceivekey != ''"> and isreceivekey = #{isreceivekey}</if>
            <if test="isreceivejunxun != null  and isreceivejunxun != ''"> and isreceivejunxun = #{isreceivejunxun}</if>
            <if test="company != null"> and company &lt;&gt; #{company}</if>
            <if test="comapproval != null  and comapproval != ''"> and comapproval = #{comapproval}</if>
            <if test="post != null  and post != ''"> and post = #{post}</if>
            <if test="situation != null  and situation != ''"> and situation = #{situation}</if>
            <if test="deptalias != null  and deptalias != ''"> and deptAlias = #{deptalias}</if>
            <if test="useralias != null  and useralias != ''"> and userAlias = #{useralias}</if>
            <if test="gradeId != null  and gradeId != ''"> and grade_id = #{gradeId}</if>
            <if test="classId != null"> and class_id = #{classId}</if>
            <if test="userId != null   and userId != ''"> and user_id = #{userId}</if>
            <if test="sbid != null   and sbid != ''"> and sbid = #{sbid}</if>
            <if test="ssid != null   and ssid != ''"> and ssid = #{ssid}</if>
            <if test="ydtime != null   and ydtime != ''"> and ydtime = #{ydtime}</if>
            <if test="ydreason != null   and ydreason != ''"> and ydreason = #{ydreason}</if>
            <if test="cardnum != null   and cardnum != ''"> and cardnum = #{cardnum}</if>
        </where>
    </select>
    <select id="selectSchoolstudentslistListnotState" parameterType="Schoolstudentslist" resultMap="SchoolstudentslistResult">
        <include refid="selectSchoolstudentslistVo"/>
        <where>  
            <if test="gender != null  and gender != ''"> and gender = #{gender}</if>
            <if test="birth != null  and studentsId != ''"> and birth = #{birth}</if>
            <if test="nation != null  and nation != ''"> and nation = #{nation}</if>
            <if test="idnum != null  and idnum != ''"> and idnum = #{idnum}</if>
            <if test="isrefuse != null  and isrefuse != ''"> and isrefuse = #{isrefuse}</if>
            <if test="approvalstate != null  and approvalstate != ''"> and approvalstate = #{approvalstate}</if>
            <if test="studentsId != null  and studentsId != ''"> and students_id = #{studentsId}</if>
            <if test="studentsName != null  and studentsName != ''"> and students_name like concat('%', #{studentsName}, '%')</if>
            <if test="academicLevel != null  and academicLevel != ''"> and academic_level = #{academicLevel}</if>
            <if test="fatherName != null  and fatherName != ''"> and father_name like concat('%', #{fatherName}, '%')</if>
            <if test="fatherPhone != null  and fatherPhone != ''"> and father_phone = #{fatherPhone}</if>
            <if test="motherName != null  and motherName != ''"> and mother_name like concat('%', #{motherName}, '%')</if>
            <if test="motherPhone != null  and motherPhone != ''"> and mother_phone = #{motherPhone}</if>
            <if test="homeAddress != null  and homeAddress != ''"> and home_address = #{homeAddress}</if>
            <if test="Remarks != null  and Remarks != ''"> and _remarks = #{Remarks}</if>
            <if test="ages != null  and ages != ''"> and ages = #{ages}</if>
            <if test="admissionTime != null "> and admission_time = #{admissionTime}</if>
            <if test="State != null  and State != ''"> and _state != #{State}</if>
            <if test="remark1 != null  and remark1 != ''"> and remark1 = #{remark1}</if>
            <if test="remark2 != null  and remark2 != ''"> and remark2 = #{remark2}</if>
            <if test="remark3 != null  and remark3 != ''"> and remark3 = #{remark3}</if>
            <if test="remark4 != null  and remark4 != ''"> and remark4 = #{remark4}</if>
            <if test="remark5 != null  and remark5 != ''"> and remark5 = #{remark5}</if>
            <if test="remark6 != null  and remark6 != ''"> and remark6 = #{remark6}</if>
            <if test="remark7 != null  and remark7 != ''"> and remark7 = #{remark7}</if>
            <if test="remark8 != null  and remark8 != ''"> and remark8 = #{remark8}</if>
            <if test="remark9 != null  and remark9 != ''"> and remark9 = #{remark9}</if>
            <if test="remark10 != null  and remark10 != ''"> and remark10 = #{remark10}</if>
            <if test="remark11 != null  and remark11 != ''"> and remark11 = #{remark11}</if>
            <if test="remark12 != null  and remark12 != ''"> and remark12 = #{remark12}</if>
            <if test="remark13 != null  and remark13 != ''"> and remark13 = #{remark13}</if>
            <if test="remark14 != null  and remark14 != ''"> and remark14 = #{remark14}</if>
            <if test="remark15 != null  and remark15 != ''"> and remark15 = #{remark15}</if>
            <if test="remark16 != null  and remark16 != ''"> and remark16 = #{remark16}</if>
            <if test="remark17 != null  and remark17 != ''"> and remark17 = #{remark17}</if>
            <if test="remark18 != null  and remark18 != ''"> and remark18 = #{remark18}</if>
            <if test="remark19 != null  and remark19 != ''"> and remark19 = #{remark19}</if>
            <if test="remark20 != null  and remark20 != ''"> and remark20 = #{remark20}</if>
            <if test="lixian1 != null  and lixian1 != ''"> and lixian1 = #{lixian1}</if>
            <if test="lixian2 != null  and lixian2 != ''"> and lixian2 = #{lixian2}</if>
            <if test="lixian3 != null  and lixian3 != ''"> and lixian3 = #{lixian3}</if>
            <if test="lixian4 != null  and lixian4 != ''"> and lixian4 = #{lixian4}</if>
            <if test="lixian5 != null  and lixian5 != ''"> and lixian5 = #{lixian5}</if>
            <if test="lixian6 != null  and lixian6 != ''"> and lixian6 = #{lixian6}</if>
            <if test="lixian7 != null  and lixian7 != ''"> and lixian7 = #{lixian7}</if>
            <if test="reportstate != null  and reportstate != ''"> and reportstate = #{reportstate}</if>
            <if test="notreportresult != null  and notreportresult != ''"> and notreportresult = #{notreportresult}</if>
            <if test="paystate != null  and paystate != ''"> and paystate = #{paystate}</if>
            <if test="isregister != null  and isregister != ''"> and isregister = #{isregister}</if>
            <if test="isreceivekey != null  and isreceivekey != ''"> and isreceivekey = #{isreceivekey}</if>
            <if test="isreceivejunxun != null  and isreceivejunxun != ''"> and isreceivejunxun = #{isreceivejunxun}</if>
            <if test="company != null  and company != ''"> and company = #{company}</if>
            <if test="comapproval != null  and comapproval != ''"> and comapproval = #{comapproval}</if>
            <if test="post != null  and post != ''"> and post = #{post}</if>
            <if test="situation != null  and situation != ''"> and situation = #{situation}</if>
            <if test="deptalias != null  and deptalias != ''"> and deptAlias = #{deptalias}</if>
            <if test="useralias != null  and useralias != ''"> and userAlias = #{useralias}</if>
            <if test="gradeId != null  and gradeId != ''"> and grade_id = #{gradeId}</if>
            <if test="classId != null  and classId != ''"> and class_id = #{classId}</if>
            <if test="userId != null   and userId != ''"> and user_id = #{userId}</if>
            <if test="sbid != null   and sbid != ''"> and sbid = #{sbid}</if>
            <if test="ssid != null   and ssid != ''"> and ssid = #{ssid}</if>
            <if test="ydtime != null   and ydtime != ''"> and ydtime = #{ydtime}</if>
            <if test="ydreason != null   and ydreason != ''"> and ydreason = #{ydreason}</if>
            <if test="cardnum != null   and cardnum != ''"> and cardnum = #{cardnum}</if>            
        </where>
    </select>
    <select id="selectSchoolstudentslistListUnMove" parameterType="Schoolstudentslist" resultMap="SchoolstudentslistResult">
        select* from (select 
        id, students_id, students_name,gender,birth,nation,idnum,isrefuse,approvalstate, academic_level, father_name, father_phone, mother_name, mother_phone, home_address, _remarks, ages, admission_time, _state, remark, remark1, remark2, remark3, remark4, remark5, remark6, remark7, remark8, remark9, remark10, remark11, remark12, remark13, remark14, remark15, remark16, remark17, del_flag, deptAlias, userAlias, grade_id, class_id 
        ,(select count(*) from school_dorm_students sds where sds.isdisuse='0' and sds.students_id=sl.id )  as isusecount
        from schoolstudentslist sl ) as aa where aa.isusecount=0 
      
    </select>
    <select id="selectSchoolstudentslistListorderbydetails" parameterType="Schoolstudentslist" resultMap="SchoolstudentslistResult">
        <include refid="selectSchoolstudentslistVo"/>
        <where>  
            <if test="studentsId != null  and studentsId != ''"> and students_id = #{studentsId}</if>
            <if test="studentsName != null  and studentsName != ''"> and students_name like concat('%', #{studentsName}, '%')</if>
            <if test="gender != null  and gender != ''"> and gender = #{gender}</if>
            <if test="birth != null  and birth != ''"> and birth = #{birth}</if>
            <if test="nation != null  and nation != ''"> and nation = #{nation}</if>
            <if test="idnum != null  and idnum != ''"> and idnum = #{idnum}</if>
            <if test="isrefuse != null  and isrefuse != ''"> and isrefuse = #{isrefuse}</if>  
            <if test="approvalstate != null  and approvalstate != ''"> and approvalstate = #{approvalstate}</if>    
            <if test="academicLevel != null  and academicLevel != ''"> and academic_level = #{academicLevel}</if>
            <if test="fatherName != null  and fatherName != ''"> and father_name like concat('%', #{fatherName}, '%')</if>
            <if test="fatherPhone != null  and fatherPhone != ''"> and father_phone = #{fatherPhone}</if>
            <if test="motherName != null  and motherName != ''"> and mother_name like concat('%', #{motherName}, '%')</if>
            <if test="motherPhone != null  and motherPhone != ''"> and mother_phone = #{motherPhone}</if>
            <if test="homeAddress != null  and homeAddress != ''"> and home_address = #{homeAddress}</if>
            <if test="Remarks != null  and Remarks != ''"> and _remarks = #{Remarks}</if>
            <if test="ages != null  and ages != ''"> and ages = #{ages}</if>
            <if test="admissionTime != null "> and admission_time = #{admissionTime}</if>
            <if test="State != null  and State != ''"> and _state = #{State}</if>
            <if test="remark1 != null  and remark1 != ''"> and remark1 = #{remark1}</if>
            <if test="remark2 != null  and remark2 != ''"> and remark2 = #{remark2}</if>
            <if test="remark3 != null  and remark3 != ''"> and remark3 = #{remark3}</if>
            <if test="remark4 != null  and remark4 != ''"> and remark4 = #{remark4}</if>
            <if test="remark5 != null  and remark5 != ''"> and remark5 = #{remark5}</if>
            <if test="remark6 != null  and remark6 != ''"> and remark6 = #{remark6}</if>
            <if test="remark7 != null  and remark7 != ''"> and remark7 = #{remark7}</if>
            <if test="remark8 != null  and remark8 != ''"> and remark8 = #{remark8}</if>
            <if test="remark9 != null  and remark9 != ''"> and remark9 = #{remark9}</if>
            <if test="remark10 != null  and remark10 != ''"> and remark10 = #{remark10}</if>
            <if test="remark11 != null  and remark11 != ''"> and remark11 = #{remark11}</if>
            <if test="remark12 != null  and remark12 != ''"> and remark12 = #{remark12}</if>
            <if test="remark13 != null  and remark13 != ''"> and remark13 = #{remark13}</if>
            <if test="remark14 != null  and remark14 != ''"> and remark14 = #{remark14}</if>
            <if test="remark15 != null  and remark15 != ''"> and remark15 = #{remark15}</if>
            <if test="remark16 != null  and remark16 != ''"> and remark16 = #{remark16}</if>
            <if test="remark17 != null  and remark17 != ''"> and remark17 = #{remark17}</if>
            <if test="remark18 != null  and remark18 != ''"> and remark18 = #{remark18}</if>
            <if test="remark19 != null  and remark19 != ''"> and remark19 = #{remark19}</if>
            <if test="remark20 != null  and remark20 != ''"> and remark20 = #{remark20}</if>
            <if test="lixian1 != null  and lixian1 != ''"> and lixian1 = #{lixian1}</if>
            <if test="lixian2 != null  and lixian2 != ''"> and lixian2 = #{lixian2}</if>
            <if test="lixian3 != null  and lixian3 != ''"> and lixian3 = #{lixian3}</if>
            <if test="lixian4 != null  and lixian4 != ''"> and lixian4 = #{lixian4}</if>
            <if test="lixian5 != null  and lixian5 != ''"> and lixian5 = #{lixian5}</if>
            <if test="lixian6 != null  and lixian6 != ''"> and lixian6 = #{lixian6}</if>
            <if test="lixian7 != null  and lixian7 != ''"> and lixian7 = #{lixian7}</if>
            <if test="reportstate != null  and reportstate != ''"> and reportstate = #{reportstate}</if>
            <if test="notreportresult != null  and notreportresult != ''"> and notreportresult = #{notreportresult}</if>
            <if test="paystate != null  and paystate != ''"> and paystate = #{paystate}</if>
            <if test="isregister != null  and isregister != ''"> and isregister = #{isregister}</if>
            <if test="isreceivekey != null  and isreceivekey != ''"> and isreceivekey = #{isreceivekey}</if>
            <if test="isreceivejunxun != null  and isreceivejunxun != ''"> and isreceivejunxun = #{isreceivejunxun}</if>
            <if test="company != null  and company != ''"> and company = #{company}</if>
            <if test="comapproval != null  and comapproval != ''"> and comapproval = #{comapproval}</if>
            <if test="situation != null  and situation != ''"> and situation = #{situation}</if>
            <if test="post != null  and post != ''"> and post = #{post}</if>
            <if test="deptalias != null  and deptalias != ''"> and deptAlias = #{deptalias}</if>
            <if test="useralias != null  and useralias != ''"> and userAlias = #{useralias}</if>
            <if test="gradeId != null  and gradeId != ''"> and grade_id = #{gradeId}</if>
            <if test="classId != null  and classId != ''"> and class_id = #{classId}</if>
            <if test="userId != null   and userId != ''"> and user_id = #{userId}</if>
            <if test="sbid != null   and sbid != ''"> and sbid = #{sbid}</if>
            <if test="ssid != null   and ssid != ''"> and ssid = #{ssid}</if>
            <if test="ydtime != null   and ydtime != ''"> and ydtime = #{ydtime}</if>
            <if test="ydreason != null   and ydreason != ''"> and ydreason = #{ydreason}</if>
            <if test="cardnum != null   and cardnum != ''"> and cardnum = #{cardnum}</if>
            
	        and id not in (select student_ID  from schoolstudentdetails where charging_details_ID = #{remark17})
        </where>
    </select>
    
    <select id="selectSchoolstudentslistById" parameterType="Long" resultMap="SchoolstudentslistResult">
        <include refid="selectSchoolstudentslistVo"/>
        where id = #{id}
    </select>
        
    <insert id="insertSchoolstudentslist" parameterType="Schoolstudentslist" useGeneratedKeys="true" keyProperty="id">
        insert into schoolstudentslist
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="studentsId != null  and studentsId != ''">students_id,</if>
            <if test="studentsName != null  and studentsName != ''">students_name,</if>            
            <if test="gender != null  and gender != ''">gender,</if>
            <if test="birth != null  and birth != ''">birth,</if>
            <if test="nation != null  and nation != ''">nation,</if>
            <if test="idnum != null  and idnum != ''">idnum,</if>
            <if test="isrefuse != null  and isrefuse != ''">isrefuse,</if>            
            <if test="approvalstate != null  and approvalstate != ''">approvalstate,</if>            
            <if test="academicLevel != null  and academicLevel != ''">academic_level,</if>
            <if test="fatherName != null  and fatherName != ''">father_name,</if>
            <if test="fatherPhone != null  and fatherPhone != ''">father_phone,</if>
            <if test="motherName != null  and motherName != ''">mother_name,</if>
            <if test="motherPhone != null  and motherPhone != ''">mother_phone,</if>
            <if test="homeAddress != null  and homeAddress != ''">home_address,</if>
            <if test="Remarks != null  and Remarks != ''">_remarks,</if>
            <if test="ages != null  and ages != ''">ages,</if>
            <if test="admissionTime != null ">admission_time,</if>
            <if test="State != null  and State != ''">_state,</if>
            <if test="remark != null  and remark != ''">remark,</if>
            <if test="remark1 != null  and remark1 != ''">remark1,</if>
            <if test="remark2 != null  and remark2 != ''">remark2,</if>
            <if test="remark3 != null  and remark3 != ''">remark3,</if>
            <if test="remark4 != null  and remark4 != ''">remark4,</if>
            <if test="remark5 != null  and remark5 != ''">remark5,</if>
            <if test="remark6 != null  and remark6 != ''">remark6,</if>
            <if test="remark7 != null  and remark7 != ''">remark7,</if>
            <if test="remark8 != null  and remark8 != ''">remark8,</if>
            <if test="remark9 != null  and remark9 != ''">remark9,</if>
            <if test="remark10 != null  and remark10 != ''">remark10,</if>
            <if test="remark11 != null  and remark11 != ''">remark11,</if>
            <if test="remark12 != null  and remark12 != ''">remark12,</if>
            <if test="remark13 != null  and remark13 != ''">remark13,</if>
            <if test="remark14 != null  and remark14 != ''">remark14,</if>
            <if test="remark15 != null  and remark15 != ''">remark15,</if>
            <if test="remark16 != null  and remark16 != ''">remark16,</if>
            <if test="remark17 != null  and remark17 != ''">remark17,</if>
            <if test="remark18 != null  and remark18 != ''">remark18,</if>
            <if test="remark19 != null  and remark19 != ''">remark19,</if>
            <if test="remark20 != null  and remark20 != ''">remark20,</if>
            <if test="lixian1 != null  and lixian1 != ''">lixian1,</if>
            <if test="lixian2 != null  and lixian2 != ''">lixian2,</if>
            <if test="lixian3 != null  and lixian3 != ''">lixian3,</if>
            <if test="lixian4 != null  and lixian4 != ''">lixian4,</if>
            <if test="lixian5 != null  and lixian5 != ''">lixian5,</if>
            <if test="lixian6 != null  and lixian6 != ''">lixian6,</if>
            <if test="lixian7 != null  and lixian7 != ''">lixian7,</if>
            <if test="reportstate != null  and reportstate != ''">reportstate,</if>
            <if test="notreportresult != null  and notreportresult != ''">notreportresult,</if>
            <if test="paystate != null  and paystate != ''">paystate,</if>
            <if test="isregister != null  and isregister != ''">isregister,</if>
            <if test="isreceivekey != null  and isreceivekey != ''">isreceivekey,</if>
            <if test="isreceivejunxun != null  and isreceivejunxun != ''">isreceivejunxun,</if>
            <if test="company != null  and company != ''">company,</if>
            <if test="comapproval != null  and comapproval != ''">comapproval,</if>
            <if test="post != null  and post != ''">post,</if>
            <if test="situation != null  and situation != ''">situation,</if>
            <if test="delFlag != null ">del_flag,</if>
            <if test="deptalias != null  and deptalias != ''">deptAlias,</if>
            <if test="useralias != null  and useralias != ''">userAlias,</if>
            <if test="gradeId != null  and gradeId != ''">grade_id,</if>
            <if test="classId != null  and classId != ''">class_id,</if>
            <if test="userId != null   and userId != ''"> user_id ,</if>
            <if test="sbid != null   and sbid != ''"> sbid ,</if>
            <if test="ssid != null   and ssid != ''"> ssid ,</if>
            <if test="ydtime != null   and ydtime != ''"> ydtime ,</if>
            <if test="ydreason != null   and ydreason != ''"> ydreason ,</if>
            <if test="cardnum != null   and cardnum != ''"> cardnum ,</if>
            
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="studentsId != null  and studentsId != ''">#{studentsId},</if>
            <if test="studentsName != null  and studentsName != ''">#{studentsName},</if>            
            <if test="gender != null  and gender != ''">#{gender},</if>
            <if test="birth != null  and birth != ''">#{birth},</if>
            <if test="nation != null  and nation != ''">#{nation},</if>
            <if test="idnum != null  and idnum != ''">#{idnum},</if>
            <if test="isrefuse != null  and isrefuse != ''">#{isrefuse},</if>            
            <if test="approvalstate != null  and approvalstate != ''">#{approvalstate},</if>            
            <if test="academicLevel != null  and academicLevel != ''">#{academicLevel},</if>
            <if test="fatherName != null  and fatherName != ''">#{fatherName},</if>
            <if test="fatherPhone != null  and fatherPhone != ''">#{fatherPhone},</if>
            <if test="motherName != null  and motherName != ''">#{motherName},</if>
            <if test="motherPhone != null  and motherPhone != ''">#{motherPhone},</if>
            <if test="homeAddress != null  and homeAddress != ''">#{homeAddress},</if>
            <if test="Remarks != null  and Remarks != ''">#{Remarks},</if>
            <if test="ages != null  and ages != ''">#{ages},</if>
            <if test="admissionTime != null ">#{admissionTime},</if>
            <if test="State != null  and State != ''">#{State},</if>
            <if test="remark != null  and remark != ''">#{remark},</if>
            <if test="remark1 != null  and remark1 != ''">#{remark1},</if>
            <if test="remark2 != null  and remark2 != ''">#{remark2},</if>
            <if test="remark3 != null  and remark3 != ''">#{remark3},</if>
            <if test="remark4 != null  and remark4 != ''">#{remark4},</if>
            <if test="remark5 != null  and remark5 != ''">#{remark5},</if>
            <if test="remark6 != null  and remark6 != ''">#{remark6},</if>
            <if test="remark7 != null  and remark7 != ''">#{remark7},</if>
            <if test="remark8 != null  and remark8 != ''">#{remark8},</if>
            <if test="remark9 != null  and remark9 != ''">#{remark9},</if>
            <if test="remark10 != null  and remark10 != ''">#{remark10},</if>
            <if test="remark11 != null  and remark11 != ''">#{remark11},</if>
            <if test="remark12 != null  and remark12 != ''">#{remark12},</if>
            <if test="remark13 != null  and remark13 != ''">#{remark13},</if>
            <if test="remark14 != null  and remark14 != ''">#{remark14},</if>
            <if test="remark15 != null  and remark15 != ''">#{remark15},</if>
            <if test="remark16 != null  and remark16 != ''">#{remark16},</if>
            <if test="remark17 != null  and remark17 != ''">#{remark17},</if>
            <if test="remark18 != null  and remark18 != ''">#{remark18},</if>
            <if test="remark19 != null  and remark19 != ''">#{remark19},</if>
            <if test="remark20 != null  and remark20 != ''">#{remark20},</if>
            <if test="lixian1 != null  and lixian1 != ''">#{lixian1},</if>
            <if test="lixian2 != null  and lixian2 != ''">#{lixian2},</if>
            <if test="lixian3 != null  and lixian3 != ''">#{lixian3},</if>
            <if test="lixian4 != null  and lixian4 != ''">#{lixian4},</if>
            <if test="lixian5 != null  and lixian5 != ''">#{lixian5},</if>
            <if test="lixian6 != null  and lixian6 != ''">#{lixian6},</if>
            <if test="lixian7 != null  and lixian7 != ''">#{lixian7},</if>
            <if test="reportstate != null  and reportstate != ''">#{reportstate},</if>
            <if test="notreportresult != null  and notreportresult != ''">#{notreportresult},</if>
            <if test="paystate != null  and paystate != ''">#{paystate},</if>
            <if test="isregister != null  and isregister != ''">#{isregister},</if>
            <if test="isreceivekey != null  and isreceivekey != ''">#{isreceivekey},</if>
            <if test="isreceivejunxun != null  and isreceivejunxun != ''">#{isreceivejunxun},</if>
            <if test="company != null  and company != ''">#{company},</if>
            <if test="comapproval != null  and comapproval != ''">#{comapproval},</if>
            <if test="post != null  and post != ''">#{post},</if>
            <if test="situation != null  and situation != ''">#{situation},</if>
            <if test="delFlag != null ">#{delFlag},</if>
            <if test="deptalias != null  and deptalias != ''">#{deptalias},</if>
            <if test="useralias != null  and useralias != ''">#{useralias},</if>
            <if test="gradeId != null  and gradeId != ''">#{gradeId},</if>
            <if test="classId != null  and classId != ''">#{classId},</if>
            <if test="userId != null   and userId != ''">#{userId},</if>
            <if test="sbid != null   and sbid != ''">#{sbid},</if>
            <if test="ssid != null   and ssid != ''">#{ssid},</if>
            <if test="ydtime != null   and ydtime != ''">#{ydtime},</if>
            <if test="ydreason != null   and ydreason != ''">#{ydreason},</if>
            <if test="cardnum != null   and cardnum != ''">#{cardnum},</if>
            
         </trim>
    </insert>

    <update id="updateSchoolstudentslist" parameterType="Schoolstudentslist">
        update schoolstudentslist
        <trim prefix="SET" suffixOverrides=",">
            <if test="studentsId != null  and studentsId != ''">students_id = #{studentsId},</if>
            <if test="studentsName != null  and studentsName != ''">students_name = #{studentsName},</if>            
            <if test="gender != null  and gender != ''">gender = #{gender},</if>
            <if test="birth != null  and birth != ''">birth = #{birth},</if>
            <if test="nation != null  and nation != ''">nation = #{nation},</if>
            <if test="idnum != null  and idnum != ''">idnum = #{idnum},</if>
            <if test="isrefuse != null  and isrefuse != ''">isrefuse = #{isrefuse},</if>    
            <if test="approvalstate != null  and approvalstate != ''">approvalstate = #{approvalstate},</if>           
            <if test="academicLevel != null  and academicLevel != ''">academic_level = #{academicLevel},</if>
            <if test="fatherName != null  and fatherName != ''">father_name = #{fatherName},</if>
            <if test="fatherPhone != null  and fatherPhone != ''">father_phone = #{fatherPhone},</if>
            <if test="motherName != null  and motherName != ''">mother_name = #{motherName},</if>
            <if test="motherPhone != null  and motherPhone != ''">mother_phone = #{motherPhone},</if>
            <if test="homeAddress != null  and homeAddress != ''">home_address = #{homeAddress},</if>
            <if test="Remarks != null  and Remarks != ''">_remarks = #{Remarks},</if>
            <if test="ages != null  and ages != ''">ages = #{ages},</if>
            <if test="admissionTime != null ">admission_time = #{admissionTime},</if>
            <if test="State != null  and State != ''">_state = #{State},</if>
            <if test="remark != null  and remark != ''">remark = #{remark},</if>
            <if test="remark1 != null  and remark1 != ''">remark1 = #{remark1},</if>
            <if test="remark2 != null  and remark2 != ''">remark2 = #{remark2},</if>
            <if test="remark3 != null  and remark3 != ''">remark3 = #{remark3},</if>
            <if test="remark4 != null  and remark4 != ''">remark4 = #{remark4},</if>
            <if test="remark5 != null  and remark5 != ''">remark5 = #{remark5},</if>
            <if test="remark6 != null  and remark6 != ''">remark6 = #{remark6},</if>
            <if test="remark7 != null  and remark7 != ''">remark7 = #{remark7},</if>
            <if test="remark8 != null  and remark8 != ''">remark8 = #{remark8},</if>
            <if test="remark9 != null  and remark9 != ''">remark9 = #{remark9},</if>
            <if test="remark10 != null  and remark10 != ''">remark10 = #{remark10},</if>
            <if test="remark11 != null  and remark11 != ''">remark11 = #{remark11},</if>
            <if test="remark12 != null  and remark12 != ''">remark12 = #{remark12},</if>
            <if test="remark13 != null  and remark13 != ''">remark13 = #{remark13},</if>
            <if test="remark14 != null  and remark14 != ''">remark14 = #{remark14},</if>
            <if test="remark15 != null  and remark15 != ''">remark15 = #{remark15},</if>
            <if test="remark16 != null  and remark16 != ''">remark16 = #{remark16},</if>
            <if test="remark17 != null  and remark17 != ''">remark17 = #{remark17},</if>
            <if test="remark18 != null  and remark18 != ''">remark18 = #{remark18},</if>
            <if test="remark19 != null  and remark19 != ''">remark19 = #{remark19},</if>
            <if test="remark20 != null  and remark20 != ''">remark20 = #{remark20},</if>
            <if test="lixian1 != null  and lixian1 != ''">lixian1 = #{lixian1},</if>
            <if test="lixian2 != null  and lixian2 != ''">lixian2 = #{lixian2},</if>
            <if test="lixian3 != null  and lixian3 != ''">lixian3 = #{lixian3},</if>
            <if test="lixian4 != null  and lixian4 != ''">lixian4 = #{lixian4},</if>
            <if test="lixian5 != null  and lixian5 != ''">lixian5 = #{lixian5},</if>
            <if test="lixian6 != null  and lixian6 != ''">lixian6 = #{lixian6},</if>
            <if test="lixian7 != null  and lixian7 != ''">lixian7 = #{lixian7},</if>
            <if test="reportstate != null  and reportstate != ''">reportstate = #{reportstate},</if>
            <if test="notreportresult != null  and notreportresult != ''">notreportresult = #{notreportresult},</if>
            <if test="paystate != null  and paystate != ''">paystate = #{paystate},</if>
            <if test="isregister != null  and isregister != ''">isregister = #{isregister},</if>
            <if test="isreceivekey != null  and isreceivekey != ''">isreceivekey = #{isreceivekey},</if>
            <if test="isreceivejunxun != null  and isreceivejunxun != ''">isreceivejunxun = #{isreceivejunxun},</if>
            <if test="company != null  and company != ''">company = #{company},</if>
            <if test="comapproval != null  and comapproval != ''">comapproval = #{comapproval},</if>
            <if test="situation != null  and situation != ''">situation = #{situation},</if>
            <if test="post != null  and post != ''">post = #{post},</if>
            <if test="delFlag != null ">del_flag = #{delFlag},</if>
            <if test="deptalias != null  and deptalias != ''">deptAlias = #{deptalias},</if>
            <if test="useralias != null  and useralias != ''">userAlias = #{useralias},</if>
            <if test="gradeId != null  and gradeId != ''">grade_id = #{gradeId},</if>
            <if test="classId != null">class_id = #{classId},</if>
            <if test="userId != null   and userId != ''">user_id= #{userId},</if>
            <if test="sbid != null   and sbid != ''">sbid= #{sbid},</if>
            <if test="ssid != null   and ssid != ''">ssid= #{ssid},</if>
            <if test="ydtime != null   and ydtime != ''">ydtime= #{ydtime},</if>
            <if test="ydreason != null   and ydreason != ''">ydreason= #{ydreason},</if>
            <if test="cardnum != null   and cardnum != ''">cardnum= #{cardnum},</if>
            
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteSchoolstudentslistById" parameterType="Long">
        delete from schoolstudentslist where id = #{id}
    </delete>

    <delete id="deleteSchoolstudentslistByIds" parameterType="String">
        delete from schoolstudentslist where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
    
    <select id="group" resultType="java.util.HashMap">
    	select count(*) as 'num' from schoolstudentslist where lixian${type}=2 and grade_id=#{grade}
    </select>
    <select id="group2" resultType="java.util.HashMap">
    	select count(*) as 'num', (select grade from schoolgradelist where id=grade_id) as 'grade_id' from schoolstudentslist where _state = 4 and grade_id is not null group by grade_id
    </select>
    <select id="group3" resultType="java.util.HashMap">
    	select count(*) as 'num', (select grade from schoolgradelist where id=grade_id) as 'grade_id' from schoolstudentslist where _state &lt;&gt; 4 and grade_id is not null group by grade_id
    </select>
    
</mapper>